#!/bin/bash

# Script de test des corrections de collaboration

echo "üß™ Test des corrections de collaboration temps r√©el"
echo "=================================================="
echo ""

# V√©rifier si Docker est disponible
if command -v docker &> /dev/null; then
    echo "‚úÖ Docker d√©tect√©"
    echo ""
    echo "Option 1: Red√©marrer avec Docker"
    echo "  docker compose -f docker-compose.dev.yml down"
    echo "  docker compose -f docker-compose.dev.yml up --build"
    echo ""
else
    echo "‚ö†Ô∏è Docker non d√©tect√©"
    echo ""
fi

echo "Option 2: Red√©marrage manuel"
echo "----------------------------"
echo ""
echo "Terminal 1 (Serveur):"
echo "  cd Server"
echo "  npm run dev"
echo ""
echo "Terminal 2 (Client):"
echo "  cd Client"
echo "  npm run dev"
echo ""
echo "=================================================="
echo ""
echo "üìù Instructions de test:"
echo ""
echo "1. Ouvrir http://localhost:3000 dans le navigateur 1"
echo "2. Se connecter et ouvrir une note"
echo "3. Ouvrir http://localhost:3000 dans le navigateur 2 (mode incognito)"
echo "4. Se connecter avec un autre compte et ouvrir la M√äME note"
echo "5. Taper du texte en m√™me temps dans les 2 navigateurs"
echo ""
echo "‚úÖ V√©rifications attendues:"
echo "  - Le curseur NE doit PAS se d√©placer automatiquement"
echo "  - 'Utilisateur √©crit...' doit s'afficher pour l'AUTRE utilisateur"
echo "  - Les modifications doivent appara√Ætre en temps r√©el"
echo "  - Pas de boucles infinies dans la console"
echo ""
echo "=================================================="
echo ""
echo "üîç Logs √† surveiller:"
echo ""
echo "Dans la console navigateur (F12):"
echo "  ‚úÖ Pas d'erreur 'socket introuvable'"
echo "  ‚úÖ Pas de boucles de messages"
echo "  ‚úÖ Messages 'Applying remote update' suivis de 'Remote update complete'"
echo ""
echo "Dans les logs serveur:"
echo "  ‚úÖ Messages 'User X connect√© √† la note'"
echo "  ‚úÖ Pas de spam de 'contentUpdate'"
echo "  ‚úÖ Sauvegardes BDD espac√©es de 1+ seconde"
echo ""
echo "=================================================="
